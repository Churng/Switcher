{"remainingRequest":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuhsuanlee/Switcher/main_vue/src/views/CartList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuhsuanlee/Switcher/main_vue/src/views/CartList.vue","mtime":1592981728606},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBjYXJ0RGF0YToge30sCiAgICAgIGxvYWRpbmc6IGZhbHNlCiAgICB9CiAgfSwKICBjcmVhdGVkICgpIHsKICAgIHRoaXMuZ2V0Q2FydERhdGEoKQogIH0sCiAgbWV0aG9kczogewogICAgb3BlbiAoaWR4KSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwh+awuOmBoOWIqumZpOipsuWVhuWTgSwg5piv5ZCm57m857qMID8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56K65a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgY29uc3QgYXBpID0gYGh0dHA6Ly9zd2l0Y2hlci5yb2NrZXQtY29kaW5nLmNvbS9hcGkvY2FydC8ke2lkeH1gCiAgICAgICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKQogICAgICAgIHRoaXMuJGh0dHAuZGVsZXRlKGFwaSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YAogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oCiAgICAgICAgICBzZXRUaW1lb3V0KF8gPT4gewogICAgICAgICAgICB0aGlzLmdldENhcnREYXRhKCkKICAgICAgICAgIH0sIDEwMCksCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBtZXNzYWdlOiAn5Yig6Zmk5oiQ5YqfIScKICAgICAgICAgIH0pCiAgICAgICAgKQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5bey5Y+W5raI5Yig6ZmkJwogICAgICAgIH0pCiAgICAgIH0pCiAgICB9LAogICAgZ2V0Q2FydERhdGEgKCkgewogICAgICB0aGlzLmNhcnREYXRhID0ge30KICAgICAgdGhpcy4kcm9vdC5nZXRDYXJ0cyA9IFtdCiAgICAgIHRoaXMuJHJvb3QuZ2V0Q2FydExlbiA9IDAKICAgICAgY29uc3QgYXBpID0gJ2h0dHA6Ly9zd2l0Y2hlci5yb2NrZXQtY29kaW5nLmNvbS9hcGkvY2FydCcKICAgICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIHRoaXMuJGh0dHAuZ2V0KGFwaSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gCiAgICAgICAgfQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgLy8g5pW055CG5oiQ6LOj5a62OntQcm9kdWN0fQogICAgICAgIGNvbnN0IGRhdGEgPSByZXMuZGF0YS5jYXJ0cwogICAgICAgIGRhdGEuZm9yRWFjaChkYXRhID0+IHsKICAgICAgICAgIGNvbnN0IHNlbGxlciA9IGRhdGEuU2VsbGVyCiAgICAgICAgICBpZiAoIXRoaXMuY2FydERhdGFbc2VsbGVyXSkgewogICAgICAgICAgICB0aGlzLiRzZXQodGhpcy5jYXJ0RGF0YSwgc2VsbGVyLCBbZGF0YV0pCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmNhcnREYXRhW3NlbGxlcl0ucHVzaChkYXRhKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLy8g5Y6f55Sf6LOH5paZCiAgICAgICAgdGhpcy4kcm9vdC5nZXRDYXJ0cyA9IHJlcy5kYXRhLmNhcnRzCiAgICAgICAgdGhpcy4kcm9vdC5nZXRDYXJ0TGVuID0gcmVzLmRhdGEuY2FydHMubGVuZ3RoCiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcnRMZW4nLCByZXMuZGF0YS5jYXJ0cy5sZW5ndGgpCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICByZXR1cm4gdGhpcy4kcm9vdC5nZXRDYXJ0cwogICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2UoZXJyKQogICAgICB9KQogICAgfSwKICAgIHRvdGFsUHJpY2UgKHZhbCkgewogICAgICB2YXIgY291bnRUb3RhbCA9IDAKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWwubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgaXRlbSA9IHZhbFtpXS5Qcm9kdWN0CiAgICAgICAgY291bnRUb3RhbCArPSBpdGVtLlRvdGFsCiAgICAgIH0KICAgICAgcmV0dXJuIGNvdW50VG90YWwudG9Mb2NhbGVTdHJpbmcoKQogICAgfSwKICAgIHRvdGFsRGVwb3NpdCAodmFsKSB7CiAgICAgIHZhciBjb3VudFRvdGFsID0gMAogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbC5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBpdGVtID0gdmFsW2ldLlByb2R1Y3QKICAgICAgICBjb3VudFRvdGFsICs9IGl0ZW0uRGVwb3NpdAogICAgICB9CiAgICAgIHJldHVybiBjb3VudFRvdGFsLnRvTG9jYWxlU3RyaW5nKCkKICAgIH0sCiAgICBnb1RvU3VibWl0IChzZWxsZXIsIGluZGV4LCBQcmljZSwgRGVwb3NpdCkgewogICAgICB2YXIgc2VsbGVySWQgPSAwCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kZXgubGVuZ3RoOyBpKyspIHsKICAgICAgICBzZWxsZXJJZCA9IGluZGV4W2ldLlNlbGxlcklkCiAgICAgIH0KICAgICAgdGhpcy4kcm9vdC5vcmRlckluZm8uc2VsbGVyID0gc2VsbGVyCiAgICAgIHRoaXMuJHJvb3Qub3JkZXJQcm9kdWN0cyA9IGluZGV4CiAgICAgIHRoaXMuJHJvb3Qub3JkZXJJbmZvLnRvdGFsUHJpY2UgPSBQcmljZQogICAgICB0aGlzLiRyb290Lm9yZGVySW5mby50b3RhbERlcG9zaXQgPSBEZXBvc2l0CiAgICAgIHRoaXMuJHJvb3Qub3JkZXJJbmZvLnRvdGFsUHJvZHVjdHMgPSBpbmRleC5sZW5ndGgKICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAnQ2FydElucHV0cycsIHBhcmFtczogeyBpZDogc2VsbGVySWQgfSB9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["CartList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CartList.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <section id=\"switcherOrder-one\" class=\"bg-light\">\n      <el-backtop :bottom=\"60\"></el-backtop>\n      <div class=\"loading vh-100\" v-if=\"loading\"><img src=\"/img/Spinner-1.1s-200px.gif\" alt=\"loading\"></div>\n      <div>\n      <div class=\"container\" v-if=\"$root.getCarts.length === 0 || this.$root.getCartLen === 0\">\n          <div class=\"text-center vh-100 d-flex flex-column justify-content-center align-items-center\">\n            <h2 class=\"font-weight-bold pt-5 pb-5\">沒有商品在購物車內</h2>\n            <span class=\"shopping\"><font-awesome-icon icon=\"cart-arrow-down\"/></span>\n          </div>\n      </div>\n      <div class=\"container mb-5\" v-if=\"$root.getCarts.length\">\n          <div class=\"row pt-5\">\n              <div class=\"col-md-6 col-10 mx-auto mt-5 mb-5\">\n                  <h4 class=\"text-center mb-3 font-weight-bold\">您的購物車</h4>\n                  <div class=\"endLine mb-4\"></div>\n              </div>\n          </div>\n          <div>\n            <div class=\"switcherOrder-orderArea border border-secondary pt-3 pb-3 pl-3 pr-3 mb-4\" v-for=\"(index, item) in cartData\" :key=\"index[0].Id\">\n              <h6><i class=\"mr-2\"><font-awesome-icon icon=\"store\"/></i>賣家帳號 : <span>{{item}}</span></h6>\n              <div class=\"row switcherOrder-content d-flex align-items-center pb-3 border-bottom border-light mb-3\" v-for=\"info in index\" :key=\"info.Id\">\n                  <div class=\"col-md-4 switcherOrder-img\">\n                      <router-link :to =\"{name: 'Product', params: { id: info.Product.ProductId }}\"><img :src=\"info.Product.ImageUrl\" alt=\"game\"></router-link>\n                  </div>\n                  <div class=\"col-md-7\">\n                      <div class=\"d-flex align-items-baseline\">\n                          <h6>{{info.Product.Name}}</h6>\n                          <span class=\"category-games bg-danger text-white ml-3 rounded\">{{info.Product.Category}}</span>\n                      </div>\n                      <div class=\"d-flex\">\n                          <div class=\"d-flex align-items-baseline mr-3\">\n                              <font-awesome-icon icon=\"user-circle\"/>\n                              <p class=\"ml-1 mb-1\">{{info.Seller}}</p>\n                          </div>\n                          <div class=\"d-flex align-items-baseline\">\n                              <span class=\"isLease-icon\"><font-awesome-icon icon=\"circle\"/></span>\n                              <span class=\"isLease\">{{info.Product.Status}}</span>\n                          </div>\n                      </div>\n                      <div class=\"content-prices d-flex align-items-baseline\">\n                          <p class=\"mb-1 mr-2\">租金 : <span >{{info.Product.Total}}</span>元</p>\n                          <p class=\"mb-1\">押金 : <span>{{info.Product.Deposit}}</span>元</p>\n                      </div>\n                      <div class=\"d-flex align-items-baseline\">\n                          <p class=\"mb-1 mr-2\">商品數量 : <span>{{info.Product.Quantity}}</span></p>\n                          <p class=\"mb-1\">面交地點 : <span>7-11 {{info.Product.Store}} 門市</span></p>\n                      </div>\n                      <div class=\"d-flex align-items-baseline sm-date\">\n                          <p class=\"mb-1\">選擇日期 : <span class=\"choosed-date\">{{info.Product.StartDate}} ~ {{info.Product.EndDate}}</span></p>\n                          <p class=\"mb-1 ml-2\">共<span>{{info.Product.Period}}</span>日</p>\n                      </div>\n                  </div>\n                  <div class=\"col-md-1 switcherOrder-delete\" @click.prevent=\"open(index[0].Id)\"><font-awesome-icon icon=\"trash-alt\"/></div>\n              </div>\n              <div class=\"d-flex justify-content-between align-items-center\">\n                  <div class=\"d-flex justify-content-end pr-3\">\n                    <p class=\"totalTxt mr-3\">總租金 : <span class=\"totalNum\">{{totalPrice(index)}}</span> 元</p>\n                    <p class=\"totalTxt ml-3\">總押金 : <span class=\"totalNum\">{{totalDeposit(index)}}</span> 元</p>\n                  </div>\n                  <el-button type=\"warning\" class=\"submitBtn\" @click.prevent=\"goToSubmit(item, index, totalPrice(index), totalDeposit(index))\">送出預約<i class=\"el-icon-sold-out ml-2\"></i></el-button>\n              </div>\n            </div>\n          </div>\n      </div>\n      <div class=\"container pb-5\">\n        <div class=\"row \">\n          <div class=\"col-12 d-flex justify-content-center\">\n            <button type=\"button\" class=\"btn btn-outline-primary btn-lg\" @click.prevent=\"$router.push('/findGames/allGame')\"><font-awesome-icon icon=\"shopping-cart\" class=\"mr-2\"/>繼續選購</button>\n          </div>\n        </div>\n      </div>\n      </div>\n    </section>\n</template>\n\n<script>\n\nexport default {\n  data () {\n    return {\n      cartData: {},\n      loading: false\n    }\n  },\n  created () {\n    this.getCartData()\n  },\n  methods: {\n    open (idx) {\n      this.$confirm('此操作將永遠刪除該商品, 是否繼續 ?', '提示', {\n        confirmButtonText: '確定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        const api = `http://switcher.rocket-coding.com/api/cart/${idx}`\n        const token = localStorage.getItem('token')\n        this.$http.delete(api, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        }).then(\n          setTimeout(_ => {\n            this.getCartData()\n          }, 100),\n          this.$message({\n            type: 'success',\n            message: '删除成功!'\n          })\n        )\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    },\n    getCartData () {\n      this.cartData = {}\n      this.$root.getCarts = []\n      this.$root.getCartLen = 0\n      const api = 'http://switcher.rocket-coding.com/api/cart'\n      const token = localStorage.getItem('token')\n      this.loading = true\n      this.$http.get(api, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }).then(res => {\n        // 整理成賣家:{Product}\n        const data = res.data.carts\n        data.forEach(data => {\n          const seller = data.Seller\n          if (!this.cartData[seller]) {\n            this.$set(this.cartData, seller, [data])\n          } else {\n            this.cartData[seller].push(data)\n          }\n        })\n        // 原生資料\n        this.$root.getCarts = res.data.carts\n        this.$root.getCartLen = res.data.carts.length\n        localStorage.setItem('cartLen', res.data.carts.length)\n        this.loading = false\n        return this.$root.getCarts\n      }).catch(err => {\n        this.$message(err)\n      })\n    },\n    totalPrice (val) {\n      var countTotal = 0\n      for (var i = 0; i < val.length; i++) {\n        var item = val[i].Product\n        countTotal += item.Total\n      }\n      return countTotal.toLocaleString()\n    },\n    totalDeposit (val) {\n      var countTotal = 0\n      for (var i = 0; i < val.length; i++) {\n        var item = val[i].Product\n        countTotal += item.Deposit\n      }\n      return countTotal.toLocaleString()\n    },\n    goToSubmit (seller, index, Price, Deposit) {\n      var sellerId = 0\n      for (var i = 0; i < index.length; i++) {\n        sellerId = index[i].SellerId\n      }\n      this.$root.orderInfo.seller = seller\n      this.$root.orderProducts = index\n      this.$root.orderInfo.totalPrice = Price\n      this.$root.orderInfo.totalDeposit = Deposit\n      this.$root.orderInfo.totalProducts = index.length\n      this.$router.push({ name: 'CartInputs', params: { id: sellerId } })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.text-muted{\n  cursor: pointer;\n}\n.switcherOrder-content .fa-trash-alt:hover{\n  color: #FF7D01;\n}\n.endLine{\n  width: 100px;\n  height: 5px;\n  background: #ededed;\n  margin: 0 auto;\n}\n.totalTxt{\n  font-size: 20px;\n}\n.totalNum{\n  font-size: 30px;\n  color: #FF7D01;\n  font-weight: 700;\n}\n.shopping{\n  font-size: 80px;\n}\n.submitBtn{\n  height: fit-content;\n}\n#switcherOrder-one{\n  min-height: calc(100vh - 12rem);\n}\n</style>\n"]}]}