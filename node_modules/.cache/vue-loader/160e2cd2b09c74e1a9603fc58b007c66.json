{"remainingRequest":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuhsuanlee/Switcher/main_vue/src/components/back_side/UploadProductphoto.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuhsuanlee/Switcher/main_vue/src/components/back_side/UploadProductphoto.vue","mtime":1592981728603},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIHNob3dJbWFnZTogewogICAgICAgIGltYWdlVXJsOiAnJywKICAgICAgICBpZDogJycKICAgICAgfSwKICAgICAgZGlhbG9nSW1hZ2VVcmw6ICcnLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgYWRkUnVsZXM6IHsgLy8g6KGo5Y2V6aqM6K+B6KeE5YiZCiAgICAgICAgcGhvdG86IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6KuL5LiK5YKz5ZWG5ZOB54WnJywgdHJpZ2dlcjogJ2JsdXInIH1dCiAgICAgIH0sCiAgICAgIG11bHRpcGxlOiB0cnVlLAogICAgICBmb3JtRGF0YTogJycsCiAgICAgIGZpbGU6ICcnCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICB1cGxvYWRTdWNjZXNzIChmaWxlKSB7CiAgICAgIHRoaXMuZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSkKICAgIH0sCiAgICBiZWZvcmVBdmF0YXJVcGxvYWQgKGZpbGUpIHsKICAgICAgY29uc3QgaXNKUEcgPSBmaWxlLnR5cGUgPT09ICdpbWFnZS9qcGVnJyB8fCAnaW1hZ2UvcG5nJwogICAgICBjb25zdCBpc0x0M00gPSBmaWxlLnNpemUgLyAzMDcyIC8gMzA3MiA8IDIKICAgICAgaWYgKCFpc0pQRykgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S4iuWCs+mgreWDj+WclueJh+WPquiDveaYryBKUEcgLyBQTkcg5qC85byPIScpCiAgICAgIH0KICAgICAgaWYgKCFpc0x0M00pIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfkuIrlgrPpoK3lg4/lnJbniYflpKflsI/kuI3og73otoXov4cgM01CIScpCiAgICAgIH0KICAgICAgLy8g5qCh6aqM5oiQ5Yqf5LiK5Lyg5paH5Lu2CiAgICAgIGlmIChpc0pQRyAmJiBpc0x0M00gPT09IHRydWUpIHsKICAgICAgICB0aGlzLmZpbGUgPSBmaWxlCiAgICAgIH0KICAgICAgcmV0dXJuIGlzSlBHICYmIGlzTHQzTQogICAgfSwKICAgIHVwbG9hZEZpbGUgKCkgewogICAgICBjb25zdCBpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZAogICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpCiAgICAgIHRoaXMuJHJlZnMudXBsb2FkLnN1Ym1pdChpZCkKICAgICAgY29uc3QgZm9ybSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgIGZvcm0uYXBwZW5kKCd1cGxvYWQnLCB0aGlzLmZpbGUpCiAgICAgIGNvbnN0IGFwaSA9IGBodHRwOi8vc3dpdGNoZXIucm9ja2V0LWNvZGluZy5jb20vYXBpL3Byb2R1Y3QvdXBsb2FkLyR7aWR9YAogICAgICB0aGlzLiRodHRwLnBvc3QoYXBpLCBmb3JtLCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAsCiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnCiAgICAgICAgfQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5waG90b1N1Y2Nlc3MocmVzLmRhdGEubWVzc2FnZSkKICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlKGVycikKICAgICAgfSkKICAgIH0sCiAgICBwaG90b1N1Y2Nlc3MgKG1zZykgewogICAgICB0aGlzLiRub3RpZnkoewogICAgICAgIHRpdGxlOiBtc2csCiAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlUmVtb3ZlIChmaWxlKSB7CiAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgdGl0bGU6IGDlt7Lnp7vpmaQgJHtmaWxlLm5hbWV9YCwKICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVQaWN0dXJlQ2FyZFByZXZpZXcgKGZpbGUpIHsKICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9IGZpbGUudXJsCiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWUKICAgIH0sCiAgICBoYW5kbGVFeGNlZWQgKGZpbGVzLCBmaWxlTGlzdCkgewogICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoYOebruWJjeWFseaciSAke2ZpbGVzLmxlbmd0aH0g5by15ZyW54mH77yM5YWx6YG45pOH5LqGICR7ZmlsZXMubGVuZ3RoICsgZmlsZUxpc3QubGVuZ3RofSDlvLXlnJbniYdgKQogICAgfSwKICAgIGluaXRJbmZvICgpIHsKICAgICAgdGhpcy5lZGl0Rm9ybSA9IHsKICAgICAgICBpZDogMSwKICAgICAgICBwaG90bzogJycKICAgICAgfQogICAgfQogIH0sCiAgaW5qZWN0OiBbJ3JlbG9hZCddLAogIHByb3BzOiBbJ1Byb2R1Y3RJbWFnZXMnXQp9Cg=="},{"version":3,"sources":["UploadProductphoto.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UploadProductphoto.vue","sourceRoot":"src/components/back_side","sourcesContent":["<template>\n  <div class=\"container\">\n        <div class=\"container\">\n          <nav aria-label=\"breadcrumb\">\n            <ol class=\"breadcrumb\">\n              <li class=\"breadcrumb-item\">\n                <a href=\"/Home\">首頁</a>\n              </li>\n              <li class=\"breadcrumb-item active\" aria-current=\"page\">編輯商品</li>\n              <li class=\"breadcrumb-item active\" aria-current=\"page\">編輯圖片</li>\n            </ol>\n          </nav>\n        </div>\n        <div class=\"NewProductImg bg-light px-4 py-4\" >\n            <h3 class=\"text-center mt-5 mb-5\">上傳商品圖片<span class=\"limitNum\">(最多1張)</span></h3>\n            <el-form class=\"form-wrapper padding\" ref=\"showImage\" :model=\"showImage\" :rules=\"addRules\">\n            <el-form-item prop=\"photo\">\n            <el-upload\n              action=\"upload\"\n              list-type=\"picture-card\"\n              :multiple=\"multiple\"\n              :limit=\"1\"\n              accept=\"image/jpeg, image/png\"\n              :before-upload=\"beforeAvatarUpload\"\n              ref=\"upload\"\n              :auto-upload=\"false\"\n              :on-exceed=\"handleExceed\"\n              :on-success=\"uploadSuccess\"\n              :on-preview=\"handlePictureCardPreview\"\n              :on-remove=\"handleRemove\"\n             >\n              <i class=\"el-icon-plus\"></i>\n            </el-upload>\n            <el-dialog :visible.sync=\"dialogVisible\">\n              <img width=\"100%\" :src=\"dialogImageUrl\">\n            </el-dialog>\n            </el-form-item >\n            </el-form>\n            <div class=\"Button mx-auto d-flex justify-content-center pt-5\">\n              <button type=\"button\" class=\"btn btn-warning\" @click.prevent=\"$router.go(-1)\">上一頁</button>\n              <button type=\"button\" class=\"btn btn-primary ml-3\"  @click.prevent=\"uploadFile()\">確定</button>\n              <button type=\"button\" class=\"btn btn-warning ml-3\"  @click.prevent=\"$router.push('/sellerstore')\">返回賣場</button>\n            </div>\n        </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      showImage: {\n        imageUrl: '',\n        id: ''\n      },\n      dialogImageUrl: '',\n      dialogVisible: false,\n      addRules: { // 表单验证规则\n        photo: [{ required: true, message: '請上傳商品照', trigger: 'blur' }]\n      },\n      multiple: true,\n      formData: '',\n      file: ''\n    }\n  },\n  methods: {\n    uploadSuccess (file) {\n      this.formData.append('file', file)\n    },\n    beforeAvatarUpload (file) {\n      const isJPG = file.type === 'image/jpeg' || 'image/png'\n      const isLt3M = file.size / 3072 / 3072 < 2\n      if (!isJPG) {\n        this.$message.error('上傳頭像圖片只能是 JPG / PNG 格式!')\n      }\n      if (!isLt3M) {\n        this.$message.error('上傳頭像圖片大小不能超过 3MB!')\n      }\n      // 校验成功上传文件\n      if (isJPG && isLt3M === true) {\n        this.file = file\n      }\n      return isJPG && isLt3M\n    },\n    uploadFile () {\n      const id = this.$route.params.id\n      const token = localStorage.getItem('token')\n      this.$refs.upload.submit(id)\n      const form = new FormData()\n      form.append('upload', this.file)\n      const api = `http://switcher.rocket-coding.com/api/product/upload/${id}`\n      this.$http.post(api, form, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(res => {\n        this.photoSuccess(res.data.message)\n      }).catch(err => {\n        this.$message(err)\n      })\n    },\n    photoSuccess (msg) {\n      this.$notify({\n        title: msg,\n        type: 'success'\n      })\n    },\n    handleRemove (file) {\n      this.$notify({\n        title: `已移除 ${file.name}`,\n        type: 'success'\n      })\n    },\n    handlePictureCardPreview (file) {\n      this.dialogImageUrl = file.url\n      this.dialogVisible = true\n    },\n    handleExceed (files, fileList) {\n      this.$message.warning(`目前共有 ${files.length} 張圖片，共選擇了 ${files.length + fileList.length} 張圖片`)\n    },\n    initInfo () {\n      this.editForm = {\n        id: 1,\n        photo: ''\n      }\n    }\n  },\n  inject: ['reload'],\n  props: ['ProductImages']\n}\n</script>\n<style lang=\"scss\" scoped>\n.NewProductImg{\n  min-height: calc(100vh - 15rem);\n}\n.limitNum{\n  font-size: 16px;\n}\n</style>\n"]}]}