{"remainingRequest":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuhsuanlee/Switcher/main_vue/src/components/front_side/ChooseProduct.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuhsuanlee/Switcher/main_vue/src/components/front_side/ChooseProduct.vue","mtime":1592644889567},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhsuanlee/Switcher/main_vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIHBpY2tlck9wdGlvbnM6IHsKICAgICAgICBzaG9ydGN1dHM6IFt7CiAgICAgICAgICB0ZXh0OiAn5pyA6L+R5LiA5ZGoJywKICAgICAgICAgIG9uQ2xpY2sgKHBpY2tlcikgewogICAgICAgICAgICBjb25zdCBlbmQgPSBuZXcgRGF0ZSgpCiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoKQogICAgICAgICAgICBzdGFydC5zZXRUaW1lKHN0YXJ0LmdldFRpbWUoKSAtIDM2MDAgKiAxMDAwICogMjQgKiA3KQogICAgICAgICAgICBwaWNrZXIuJGVtaXQoJ3BpY2snLCBbc3RhcnQsIGVuZF0pCiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgdGV4dDogJ+acgOi/keS4gOS4quaciCcsCiAgICAgICAgICBvbkNsaWNrIChwaWNrZXIpIHsKICAgICAgICAgICAgY29uc3QgZW5kID0gbmV3IERhdGUoKQogICAgICAgICAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKCkKICAgICAgICAgICAgc3RhcnQuc2V0VGltZShzdGFydC5nZXRUaW1lKCkgLSAzNjAwICogMTAwMCAqIDI0ICogMzApCiAgICAgICAgICAgIHBpY2tlci4kZW1pdCgncGljaycsIFtzdGFydCwgZW5kXSkKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICB0ZXh0OiAn5pyA6L+R5LiJ5Liq5pyIJywKICAgICAgICAgIG9uQ2xpY2sgKHBpY2tlcikgewogICAgICAgICAgICBjb25zdCBlbmQgPSBuZXcgRGF0ZSgpCiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoKQogICAgICAgICAgICBzdGFydC5zZXRUaW1lKHN0YXJ0LmdldFRpbWUoKSAtIDM2MDAgKiAxMDAwICogMjQgKiA5MCkKICAgICAgICAgICAgcGlja2VyLiRlbWl0KCdwaWNrJywgW3N0YXJ0LCBlbmRdKQogICAgICAgICAgfQogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIHZhbHVlMTogJzAnLAogICAgICBxdWFudGl0eTogMCwKICAgICAgdG90YWxEYXk6IDAKICAgIH0KICB9LAogIHByb3BzOiBbJ3Byb2R1Y3QnLCAnYWxsRGF0YSddLAogIGNvbXB1dGVkOiB7CiAgICB0b3RhbERheXMgKCkgewogICAgICBjb25zdCBzRGF0ZTEgPSB0aGlzLnZhbHVlMVswXQogICAgICBjb25zdCBzRGF0ZTIgPSB0aGlzLnZhbHVlMVsxXQogICAgICB2YXIgYURhdGUsIG9EYXRlMSwgb0RhdGUyLCBpRGF5cwogICAgICBpZiAodGhpcy52YWx1ZTEgPT09ICcwJykgewogICAgICAgIHJldHVybiAnMCcKICAgICAgfSBlbHNlIHsKICAgICAgICBhRGF0ZSA9IHNEYXRlMS5zcGxpdCgnLScpCiAgICAgICAgLy8g6L2J5o+b54K6MTItMTgtMjAwMuagvOW8jwogICAgICAgIG9EYXRlMSA9IG5ldyBEYXRlKGFEYXRlWzFdICsgJy0nICsgYURhdGVbMl0gKyAnLScgKyBhRGF0ZVswXSkKICAgICAgICBhRGF0ZSA9IHNEYXRlMi5zcGxpdCgnLScpCiAgICAgICAgb0RhdGUyID0gbmV3IERhdGUoYURhdGVbMV0gKyAnLScgKyBhRGF0ZVsyXSArICctJyArIGFEYXRlWzBdKQogICAgICAgIC8vIOaKiuebuOW3rueahOavq+enkuaVuOi9ieaPm+eCuuWkqeaVuAogICAgICAgIGlEYXlzID0gcGFyc2VJbnQoTWF0aC5hYnMob0RhdGUxIC0gb0RhdGUyKSAvIDEwMDAgLyA2MCAvIDYwIC8gMjQpCiAgICAgICAgcmV0dXJuIGlEYXlzCiAgICAgIH0KICAgIH0sCiAgICByZXR1cm5EYXRlICgpIHsKICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZSgpCiAgICAgIHZhciBzdHIgPSBzdGFydC5nZXRGdWxsWWVhcigpICsgJy0nICsgKHN0YXJ0LmdldE1vbnRoKCkgKyAxKSArICctJyArIHN0YXJ0LmdldERhdGUoKQogICAgICByZXR1cm4gdGhpcy5nZXROZXdEYXkoc3RyLCB0aGlzLnByb2R1Y3QuUGVyaW9kKQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgaXNMb2dpbiAoKSB7CiAgICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykKICAgICAgaWYgKCF0b2tlbikgewogICAgICAgIHRoaXMub3BlbkxvZ2luSW5mbygpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKCh0aGlzLnZhbHVlMSA9PT0gJycgJiYgdGhpcy5xdWFudGl0eSA9PT0gMCkgfHwgKHRoaXMudmFsdWUxID09PSAnJykgfHwgKHRoaXMucXVhbnRpdHkgPT09IDApKSB7CiAgICAgICAgICB0aGlzLm9wZW5BbGVydCgpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh0aGlzLiRyb290LmdldENhcnRMZW4gPiAwKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuZ2V0Q2FydHMuZmlsdGVyKG9iaiA9PiB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuYWxsRGF0YS5tZW1iZXIuSWQgIT09IG9iai5TZWxsZXJJZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zdEVyckluZm8oKQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wb3N0RGF0YSgpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5wb3N0RGF0YSgpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcG9zdERhdGEgKCkgewogICAgICBjb25zdCBhcGkgPSAnaHR0cDovL3N3aXRjaGVyLnJvY2tldC1jb2RpbmcuY29tL2FwaS9jYXJ0JwogICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpCiAgICAgIHRoaXMuJGh0dHAucG9zdChhcGksIHsKICAgICAgICBQcm9kdWN0SWQ6IHRoaXMucHJvZHVjdC5JZCwKICAgICAgICBRdWFudGl0eTogdGhpcy5xdWFudGl0eSwKICAgICAgICBTdGFydERhdGU6IHRoaXMudmFsdWUxWzBdLAogICAgICAgIEVuZERhdGU6IHRoaXMudmFsdWUxWzFdLAogICAgICAgIFBlcmlvZDogdGhpcy50b3RhbERheXMKICAgICAgfSwKICAgICAgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gCiAgICAgICAgfQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy4kcm9vdC5nZXRDYXJ0cyA9IHJlcy5kYXRhLmNhcnRzCiAgICAgICAgdGhpcy4kcm9vdC5nZXRDYXJ0TGVuID0gcmVzLmRhdGEuY2FydHMubGVuZ3RoCiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcnRMZW4nLCByZXMuZGF0YS5jYXJ0cy5sZW5ndGgpCiAgICAgICAgdGhpcy5jb3JyZWN0UG9zdCgpCiAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZShlcnIpCiAgICAgIH0pCiAgICB9LAogICAgb3BlbkFsZXJ0ICgpIHsKICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgbWVzc2FnZTogJ+iri+ato+eiuui8uOWFpeenn+WAn+aXpeacny/llYblk4Hmlbjph48nLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KQogICAgfSwKICAgIG9wZW5Mb2dpbkluZm8gKCkgewogICAgICB0aGlzLiRub3RpZnkuaW5mbyh7CiAgICAgICAgdGl0bGU6ICflsJrmnKrnmbvlhaXmnIPlk6EhIOiri+WFiOeZu+WFpeW+jOWGjeS4i+WWruWRpu+8gScKICAgICAgfSkKICAgIH0sCiAgICBjb3JyZWN0UG9zdCAoKSB7CiAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgdGl0bGU6ICflt7LliqDlhaXos7znianou4onLAogICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICB9KQogICAgfSwKICAgIHBvc3RFcnJJbmZvICgpIHsKICAgICAgdGhpcy4kbm90aWZ5LmVycm9yKHsKICAgICAgICB0aXRsZTogJ+atpOWVhuWTgei3n+aCqOizvOeJqei7iuijoeeahOizo+WutuS4jeespizoq4vlhYjntZDllq7lvozlho3poJDntITlkabvvIEnCiAgICAgIH0pCiAgICB9LAogICAgZ2V0TmV3RGF5ICh0b2RheSwgZGF5cykgewogICAgICB2YXIgZGF0ZVRlbXAgPSB0b2RheS5zcGxpdCgnLScpCiAgICAgIHZhciBuRGF0ZSA9IG5ldyBEYXRlKGRhdGVUZW1wWzFdICsgJy0nICsgZGF0ZVRlbXBbMl0gKyAnLScgKyBkYXRlVGVtcFswXSkvLyDovazmjaLkuLpNTS1ERC1ZWVlZ5qC85byPCiAgICAgIC8vIOWFvOWuueeBq+eLkOaXtumXtOaIswogICAgICBpZiAobkRhdGUgPT09ICdJbnZhbGlkIERhdGUnKSB7CiAgICAgICAgbkRhdGUgPSBuZXcgRGF0ZShkYXRlVGVtcFsxXSArICcvJyArIGRhdGVUZW1wWzJdICsgJy8nICsgZGF0ZVRlbXBbMF0pCiAgICAgIH0KICAgICAgdmFyIG1pbGxTZWNvbmRzID0gTWF0aC5hYnMobkRhdGUpICsgKGRheXMgKiAyNCAqIDYwICogNjAgKiAxMDAwKQogICAgICB2YXIgckRhdGUgPSBuZXcgRGF0ZShtaWxsU2Vjb25kcykKICAgICAgdmFyIHllYXIgPSByRGF0ZS5nZXRGdWxsWWVhcigpCiAgICAgIHZhciBtb250aCA9IHJEYXRlLmdldE1vbnRoKCkgKyAxCiAgICAgIGlmIChtb250aCA8IDEwKSBtb250aCA9ICcwJyArIG1vbnRoCiAgICAgIHZhciBkYXRlID0gckRhdGUuZ2V0RGF0ZSgpCiAgICAgIGlmIChkYXRlIDwgMTApIGRhdGUgPSAnMCcgKyBkYXRlCiAgICAgIHJldHVybiAoeWVhciArICctJyArIG1vbnRoICsgJy0nICsgZGF0ZSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["ChooseProduct.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChooseProduct.vue","sourceRoot":"src/components/front_side","sourcesContent":["<template>\n    <div class=\"columns-choose\">\n        <div class=\"choosed\">\n            <div class=\"rentDate\">\n                <div>請選擇日期 : </div>\n                <div class=\"d-flex align-items-baseline mt-3\">\n                    <el-date-picker\n                      v-model=\"value1\"\n                      type=\"daterange\"\n                      value-format=\"yyyy-MM-dd\"\n                      range-separator=\"至\"\n                      start-placeholder=\"開始日期\"\n                      end-placeholder=\"结束日期\">\n                  </el-date-picker>\n                  <p class=\"total-rentDate ml-2\">共<span>{{totalDays}}</span>日</p>\n                </div>\n            </div>\n            <div class=\"quantity d-flex align-items-baseline mt-3 mb-3\">\n                <p class=\"mr-4\">商品數量</p>\n                <el-select v-model=\"quantity\" placeholder=\"请選擇數量\">\n                   <el-option\n                    v-for=\"(item, index) in product.Quantity\"\n                    :key=\"index\"\n                    :label=\"item\"\n                    :value=\"item\">\n                  </el-option>\n                </el-select>\n            </div>\n            <div class=\"columns-btnArea mb-4\">\n                <button type=\"button\" class=\"btn btn-warning w-100\" @click=\"isLogin\" v-if=\"product.Status==='可出租'\">我要租借</button>\n                <button type=\"button\" class=\"btn btn-secondary w-100\" disabled v-else>我要租借</button>\n                <h6 class=\"mt-2\" v-if=\"product.Status==='已出租'\">*預計歸還時間 : {{returnDate}}</h6>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      pickerOptions: {\n        shortcuts: [{\n          text: '最近一周',\n          onClick (picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7)\n            picker.$emit('pick', [start, end])\n          }\n        }, {\n          text: '最近一个月',\n          onClick (picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30)\n            picker.$emit('pick', [start, end])\n          }\n        }, {\n          text: '最近三个月',\n          onClick (picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90)\n            picker.$emit('pick', [start, end])\n          }\n        }]\n      },\n      value1: '0',\n      quantity: 0,\n      totalDay: 0\n    }\n  },\n  props: ['product', 'allData'],\n  computed: {\n    totalDays () {\n      const sDate1 = this.value1[0]\n      const sDate2 = this.value1[1]\n      var aDate, oDate1, oDate2, iDays\n      if (this.value1 === '0') {\n        return '0'\n      } else {\n        aDate = sDate1.split('-')\n        // 轉換為12-18-2002格式\n        oDate1 = new Date(aDate[1] + '-' + aDate[2] + '-' + aDate[0])\n        aDate = sDate2.split('-')\n        oDate2 = new Date(aDate[1] + '-' + aDate[2] + '-' + aDate[0])\n        // 把相差的毫秒數轉換為天數\n        iDays = parseInt(Math.abs(oDate1 - oDate2) / 1000 / 60 / 60 / 24)\n        return iDays\n      }\n    },\n    returnDate () {\n      const start = new Date()\n      var str = start.getFullYear() + '-' + (start.getMonth() + 1) + '-' + start.getDate()\n      return this.getNewDay(str, this.product.Period)\n    }\n  },\n  methods: {\n    isLogin () {\n      const token = localStorage.getItem('token')\n      if (!token) {\n        this.openLoginInfo()\n      } else {\n        if ((this.value1 === '' && this.quantity === 0) || (this.value1 === '') || (this.quantity === 0)) {\n          this.openAlert()\n        } else {\n          if (this.$root.getCartLen > 0) {\n            this.$root.getCarts.filter(obj => {\n              if (this.allData.member.Id !== obj.SellerId) {\n                return this.postErrInfo()\n              } else {\n                return this.postData()\n              }\n            })\n          } else {\n            this.postData()\n          }\n        }\n      }\n    },\n    postData () {\n      const api = 'http://switcher.rocket-coding.com/api/cart'\n      const token = localStorage.getItem('token')\n      this.$http.post(api, {\n        ProductId: this.product.Id,\n        Quantity: this.quantity,\n        StartDate: this.value1[0],\n        EndDate: this.value1[1],\n        Period: this.totalDays\n      },\n      {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }).then(res => {\n        this.$root.getCarts = res.data.carts\n        this.$root.getCartLen = res.data.carts.length\n        localStorage.setItem('cartLen', res.data.carts.length)\n        this.correctPost()\n      }).catch(err => {\n        this.$message(err)\n      })\n    },\n    openAlert () {\n      this.$message({\n        message: '請正確輸入租借日期/商品數量',\n        type: 'warning'\n      })\n    },\n    openLoginInfo () {\n      this.$notify.info({\n        title: '尚未登入會員! 請先登入後再下單呦！'\n      })\n    },\n    correctPost () {\n      this.$notify({\n        title: '已加入購物車',\n        type: 'success'\n      })\n    },\n    postErrInfo () {\n      this.$notify.error({\n        title: '此商品跟您購物車裡的賣家不符,請先結單後再預約呦！'\n      })\n    },\n    getNewDay (today, days) {\n      var dateTemp = today.split('-')\n      var nDate = new Date(dateTemp[1] + '-' + dateTemp[2] + '-' + dateTemp[0])// 转换为MM-DD-YYYY格式\n      // 兼容火狐时间戳\n      if (nDate === 'Invalid Date') {\n        nDate = new Date(dateTemp[1] + '/' + dateTemp[2] + '/' + dateTemp[0])\n      }\n      var millSeconds = Math.abs(nDate) + (days * 24 * 60 * 60 * 1000)\n      var rDate = new Date(millSeconds)\n      var year = rDate.getFullYear()\n      var month = rDate.getMonth() + 1\n      if (month < 10) month = '0' + month\n      var date = rDate.getDate()\n      if (date < 10) date = '0' + date\n      return (year + '-' + month + '-' + date)\n    }\n  }\n}\n</script>\n"]}]}